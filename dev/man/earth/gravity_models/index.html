<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Gravity models · Satellite Toolbox</title><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://juliaspace.github.io/SatelliteToolbox.jl/stable/man/earth/gravity_models/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="Satellite Toolbox logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Satellite Toolbox</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Earth</span><ul><li><a class="tocitem" href="../atmospheric_models/">Earth atmospheric models</a></li><li><a class="tocitem" href="../geomagnetic_field_models/">Earth geomagnetic field models</a></li><li class="is-active"><a class="tocitem" href>Gravity models</a><ul class="internal"><li><a class="tocitem" href="#Computing-the-gravitational-potential"><span>Computing the gravitational potential</span></a></li><li><a class="tocitem" href="#Computing-the-gravitational-potential-derivatives"><span>Computing the gravitational potential derivatives</span></a></li><li><a class="tocitem" href="#Computing-the-gravitational-acceleration"><span>Computing the gravitational acceleration</span></a></li></ul></li><li><a class="tocitem" href="../space_indices/">Space indices</a></li></ul></li><li><span class="tocitem">Orbit</span><ul><li><a class="tocitem" href="../../orbit/anomalies/">Anomalies</a></li><li><a class="tocitem" href="../../orbit/general/">General analysis</a></li><li><a class="tocitem" href="../../orbit/propagators/">Orbit propagators</a></li><li><a class="tocitem" href="../../orbit/tle/">TLE</a></li></ul></li><li><span class="tocitem">Transformations</span><ul><li><a class="tocitem" href="../../transformations/ecef_eci/">ECEF and ECI</a></li><li><a class="tocitem" href="../../transformations/geodetic_geocentric/">Geodetic and Geocentric</a></li></ul></li><li><a class="tocitem" href="../../../lib/library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Earth</a></li><li class="is-active"><a href>Gravity models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Gravity models</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaSpace/SatelliteToolbox.jl/blob/master/docs/src/man/earth/gravity_models.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Gravity-models"><a class="docs-heading-anchor" href="#Gravity-models">Gravity models</a><a id="Gravity-models-1"></a><a class="docs-heading-anchor-permalink" href="#Gravity-models" title="Permalink"></a></h1><p>SatelliteToolbox.jl supports gravity models in which the coefficients are provided in an <a href="http://icgem.gfz-potsdam.de/home">ICGEM</a> file.</p><p>Before using a gravity model, we must load the coefficients from the input file. This process can be accomplished by the function <code>parse_icgem</code>:</p><pre><code class="language-julia hljs">julia&gt; egm96_model = parse_icgem(&quot;EGM96.gfc&quot;)
ICGEM
  product_type: String &quot;gravity_field&quot;
  modelname: String &quot;EGM96&quot;
  gravity_constant: Float64 3.986004415e14
  radius: Float64 6.3781363e6
  max_degree: Int64 360
  errors: Symbol formal
  tide_system: Symbol tide_free
  norm: Symbol fully_normalized
  Clm: Array{Float64}((361, 361)) [1.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; -6.34777471268e-11 5.36287680346e-11 … 6.27016396298e-11 0.0; 7.95017157688e-12 1.10754853834e-12 … 1.83971631467e-11 -4.47516389678e-25]
  Slm: Array{Float64}((361, 361)) [0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 2.58517700048e-11 … -6.18987012099e-11 0.0; 0.0 -6.27959348935e-11 … -3.10123632209e-11 -8.30224945525e-11]
  sigmaC: Array{Float64}((361, 361)) [0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 6.4425138e-11 3.8751548e-11 … 6.3040162e-11 0.0; 5.0033977e-11 5.0033977e-11 … 5.0033977e-11 5.0033977e-11]
  sigmaC_formal: Array{Float64}((0, 0)) Matrix{Float64}(undef, 0, 0)
  sigmaS: Array{Float64}((361, 361)) [0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 3.8983376e-11 … 6.2932021e-11 0.0; 5.0033977e-11 5.0033977e-11 … 5.0033977e-11 5.0033977e-11]
  sigmaS_formal: Array{Float64}((0, 0)) Matrix{Float64}(undef, 0, 0)</code></pre><p>It loads all the information in the ICGEM file and stores in an <code>ICGEM</code> structure.</p><p>SatelliteToolbox.jl currently supports three functions using gravity models:</p><ol><li>Computing the gravitational potential at a specific location;</li><li>Computing the gravitational potential derivatives (spherical coordinates) at a specific location; and</li><li>Computing the gravitational acceleration at a specific location.</li></ol><p>For all those tasks, we initially need to process the information in the <code>ICGEM</code> structure into an object of type <code>GravityModel_Coefs</code>. This action is accomplished by the function <code>create_gravity_model_coefs</code>:</p><pre><code class="language-julia hljs">julia&gt; egm96_coefs = create_gravity_model_coefs(egm96_model)
GravityModel_Coefs{Float64}
  name: String &quot;EGM96&quot;
  μ: Float64 3.986004415e14
  R0: Float64 6.3781363e6
  legendre_norm: Symbol full
  n_max: Int64 360
  C: Array{Float64}((361, 361)) [1.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; -6.34777471268e-11 5.36287680346e-11 … 6.27016396298e-11 0.0; 7.95017157688e-12 1.10754853834e-12 … 1.83971631467e-11 -4.47516389678e-25]
  S: Array{Float64}((361, 361)) [0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 2.58517700048e-11 … -6.18987012099e-11 0.0; 0.0 -6.27959348935e-11 … -3.10123632209e-11 -8.30224945525e-11]</code></pre><p>Finally, the object <code>egm96_coefs</code> is used to perform the computations.</p><p>Notice that SatelliteToolbox.jl provides three built-in gravity models. Their <code>GravityModel_Coefs</code> objects can be loaded using the function <code>load_gravity_model(T)</code>, where <code>T</code> can be:</p><ul><li><code>EGM96()</code> for the Earth Gravitational Model 1996 (EGM96);</li><li><code>JGM2()</code> for the Joint Earth Gravity Model 2 (JGM2); or</li><li><code>JGM3()</code> for the Joint Earth Gravity Model 3 (JGM3).</li></ul><pre><code class="language-julia-repl hljs">julia&gt; egm96_coefs = load_gravity_model(EGM96())
GravityModel_Coefs{Float64}
  name: String &quot;EGM96&quot;
  μ: Float64 3.986004415e14
  R0: Float64 6.3781363e6
  legendre_norm: Symbol full
  n_max: Int64 360
  C: Array{Float64}((361, 361)) [1.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; -6.34777471268e-11 5.36287680346e-11 … 6.27016396298e-11 0.0; 7.95017157688e-12 1.10754853834e-12 … 1.83971631467e-11 -4.47516389678e-25]
  S: Array{Float64}((361, 361)) [0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 2.58517700048e-11 … -6.18987012099e-11 0.0; 0.0 -6.27959348935e-11 … -3.10123632209e-11 -8.30224945525e-11]</code></pre><h2 id="Computing-the-gravitational-potential"><a class="docs-heading-anchor" href="#Computing-the-gravitational-potential">Computing the gravitational potential</a><a id="Computing-the-gravitational-potential-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-the-gravitational-potential" title="Permalink"></a></h2><p>The gravitational potential [J/kg] at a specific location can be computed using the function <code>compute_U</code>. The function signature is:</p><pre><code class="language-julia hljs">compute_U(gm_coefs::GravityModel_Coefs{T}, r::AbstractVector, n_max::Number = -1, m_max::Number = -1) where T&lt;:Number</code></pre><p>where:</p><ul><li><code>gm_coefs</code> is the object that holds the gravity model coefficients (see <a href="../../../lib/library/#SatelliteToolbox.GravityModel_Coefs"><code>GravityModel_Coefs</code></a>); and</li><li><code>r</code> is the position vector of the desired location represented in ITRF [m].</li></ul><p>The arguments <code>n_max</code> and <code>m_max</code> can be used to limit the maximum degree and order the algorithm will use when computing the spherical harmonics. All the available information within the model is considered if they are negative.</p><pre><code class="language-julia-repl hljs">julia&gt; egm96_coefs = load_gravity_model(EGM96());

julia&gt; compute_U(egm96_coefs, [6378e3, 0, 0])
6.2530209756063506e7</code></pre><h2 id="Computing-the-gravitational-potential-derivatives"><a class="docs-heading-anchor" href="#Computing-the-gravitational-potential-derivatives">Computing the gravitational potential derivatives</a><a id="Computing-the-gravitational-potential-derivatives-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-the-gravitational-potential-derivatives" title="Permalink"></a></h2><p>The gravitational potential derivatives w.r.t. the spherical coordinates (<code>∂U/∂r</code>, <code>∂U/∂ϕ</code>, <code>∂U/∂λ</code>) at specific location can be computed using the function <code>compute_dU</code>. The function signature is:</p><pre><code class="language-julia hljs">compute_dU(gm_coefs::GravityModel_Coefs{T}, r::AbstractVector, n_max::Number = -1, m_max::Number = -1) where T&lt;:Number</code></pre><p>where:</p><ul><li><code>gm_coefs</code> is the object that holds the gravity model coefficients (see <a href="../../../lib/library/#SatelliteToolbox.GravityModel_Coefs"><code>GravityModel_Coefs</code></a>); and</li><li><code>r</code> is the position vector of the desired location represented in ITRF [m].</li></ul><p>The arguments <code>n_max</code> and <code>m_max</code> can be used to limit the maximum degree and order the algorithm will use when computing the spherical harmonics. All the available information within the model is considered if they are negative.</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>In this case, <code>ϕ</code> is the geocentric latitude and <code>λ</code> is the geocentric longitude.</p></div></div><pre><code class="language-julia hljs">julia&gt; egm96_coefs = load_gravity_model(EGM96());

julia&gt; compute_dU(egm96_coefs, [6378e3, 0, 0])
(-9.81470672242183, 50.712111877176156, -116.12345916122457)</code></pre><h2 id="Computing-the-gravitational-acceleration"><a class="docs-heading-anchor" href="#Computing-the-gravitational-acceleration">Computing the gravitational acceleration</a><a id="Computing-the-gravitational-acceleration-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-the-gravitational-acceleration" title="Permalink"></a></h2><p>The gravitational acceleration vector [m/s²] represented in the ITRF at specific location can be computed using the function <code>compute_g</code>. The function signature is:</p><pre><code class="language-julia hljs">compute_g(gm_coefs::GravityModel_Coefs{T}, r::AbstractVector, n_max::Number = -1, m_max::Number = -1) where T&lt;:Number</code></pre><ul><li><code>gm_coefs</code> is the object that holds the gravity model coefficients (see <a href="../../../lib/library/#SatelliteToolbox.GravityModel_Coefs"><code>GravityModel_Coefs</code></a>); and</li><li><code>r</code> is the position vector of the desired location represented in ITRF [m].</li></ul><p>The arguments <code>n_max</code> and <code>m_max</code> can be used to limit the maximum degree and order the algorithm will use when computing the spherical harmonics. All the available information within the model is considered if they are negative.</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Notice that this function computes the <strong>gravitational acceleration</strong>. Hence, the acceleration due to Earth&#39;s rotation rate <strong>is not</strong> included.</p></div></div><pre><code class="language-julia-repl hljs">julia&gt; egm96_coefs = load_gravity_model(EGM96());

julia&gt; compute_g(egm96_coefs, [6378e3, 0, 0])
3-element StaticArraysCore.SVector{3, Float64} with indices SOneTo(3):
 -9.81470672242183
 -1.8206876632365096e-5
  7.95109938494452e-6</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../geomagnetic_field_models/">« Earth geomagnetic field models</a><a class="docs-footer-nextpage" href="../space_indices/">Space indices »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 13 March 2023 18:40">Monday 13 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
