<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Earth atmospheric models · Satellite Toolbox</title><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://juliaspace.github.io/SatelliteToolbox.jl/stable/man/earth/atmospheric_models/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="Satellite Toolbox logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Satellite Toolbox</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Earth</span><ul><li class="is-active"><a class="tocitem" href>Earth atmospheric models</a><ul class="internal"><li><a class="tocitem" href="#Exponential-atmospheric-model"><span>Exponential atmospheric model</span></a></li><li><a class="tocitem" href="#Jacchia-Roberts-1971"><span>Jacchia-Roberts 1971</span></a></li><li><a class="tocitem" href="#Jacchia-Bowman-2008"><span>Jacchia-Bowman 2008</span></a></li><li><a class="tocitem" href="#NRLMSISE-00"><span>NRLMSISE-00</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../geomagnetic_field_models/">Earth geomagnetic field models</a></li><li><a class="tocitem" href="../space_indices/">Space indices</a></li></ul></li><li><span class="tocitem">Orbit</span><ul><li><a class="tocitem" href="../../orbit/anomalies/">Anomalies</a></li><li><a class="tocitem" href="../../orbit/general/">General analysis</a></li><li><a class="tocitem" href="../../orbit/propagators/">Orbit propagators</a></li><li><a class="tocitem" href="../../orbit/tle/">TLE</a></li></ul></li><li><span class="tocitem">Transformations</span><ul><li><a class="tocitem" href="../../transformations/ecef_eci/">ECEF and ECI</a></li><li><a class="tocitem" href="../../transformations/geodetic_geocentric/">Geodetic and Geocentric</a></li></ul></li><li><a class="tocitem" href="../../../lib/library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Earth</a></li><li class="is-active"><a href>Earth atmospheric models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Earth atmospheric models</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaSpace/SatelliteToolbox.jl/blob/master/docs/src/man/earth/atmospheric_models.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Earth-atmospheric-models"><a class="docs-heading-anchor" href="#Earth-atmospheric-models">Earth atmospheric models</a><a id="Earth-atmospheric-models-1"></a><a class="docs-heading-anchor-permalink" href="#Earth-atmospheric-models" title="Permalink"></a></h1><p>This package implements natively three atmospheric models:</p><ul><li>Exponential atmospheric model according to [1];</li><li>Jacchia-Roberts 1971;</li><li><a href="http://sol.spacenvironment.net/jb2008/">Jacchia-Bowman 2008</a>; and</li><li><a href="https://ccmc.gsfc.nasa.gov/modelweb/models/nrlmsise00.php">NRLMSISE-00</a>.</li></ul><h2 id="Exponential-atmospheric-model"><a class="docs-heading-anchor" href="#Exponential-atmospheric-model">Exponential atmospheric model</a><a id="Exponential-atmospheric-model-1"></a><a class="docs-heading-anchor-permalink" href="#Exponential-atmospheric-model" title="Permalink"></a></h2><p>This model assumes that the atmospheric density is computed by:</p><p class="math-container">\[\rho(h) = \rho_0 \cdot exp \left\lbrace - \frac{h - h_0}{H} \right\rbrace~,\]</p><p>in which <span>$\rho_0$</span>, <span>$h_0$</span>, and <span>$H$</span> are parameters obtained from tables. Reference [1] provides a discretization of those parameters based on the selected height <span>$h$</span> that was obtained after evaluation of some accurate models.</p><p>In this toolbox, the model can be evaluated using the following function:</p><pre><code class="language-julia">function expatmosphere(h::Number)</code></pre><p>in which <code>h</code> is the desired height in meters.</p><pre><code class="language-julia-repl">julia&gt; expatmosphere(700e3)
3.614e-14</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Notice that this model does not consider important effects such as the Sun activity, the geomagnetic activity, the local time at the desired location, etc.  Hence, although this can be used for fast evaluations, the accuracy is not good.</p></div></div><h2 id="Jacchia-Roberts-1971"><a class="docs-heading-anchor" href="#Jacchia-Roberts-1971">Jacchia-Roberts 1971</a><a id="Jacchia-Roberts-1971-1"></a><a class="docs-heading-anchor-permalink" href="#Jacchia-Roberts-1971" title="Permalink"></a></h2><p>This is an analytic atmospheric model based on the Jacchia&#39;s 1970 model. It was published in:</p><blockquote><p><strong>Roberts, C. E (1971)</strong>. <em>An analytic model for upper atmosphere densities based upon Jacchia&#39;s 1970 models</em>. <strong>Celestial mechanics</strong>, Vol. 4 (3-4), p. 368-377, DOI: 10.1007/BF01231398.</p></blockquote><p>Although it is quite old, this model is still used for some applications, like computing the estimated reentry time for an object on low Earth orbits.</p><p>In this toolbox, the model can be evaluated using the following function:</p><pre><code class="language-julia">function jr1971(JD::Number, glat::Number, glon::Number, h::Number, F10::Number, F10ₐ::Number, Kp::Number)</code></pre><p>in which:</p><ul><li><code>JD</code>: Julian day.</li><li><code>glat</code>: Geodetic latitude [rad].</li><li><code>glon</code>: Geodetic longitude [rad].</li><li><code>h</code>: Altitude [m].</li><li><code>F10</code>: 10.7-cm solar flux [10⁻²² W/(M² Hz)].</li><li><code>F10ₐ</code>: 10.7-cm averaged solar flux, 81-day centered on input time.</li><li><code>Kp</code>: Kp geomagnetic index (with a delay of 3 hours).</li></ul><p>Unfortunately, it does not support fetching the space indices automatically yet.</p><p>This function returns an object of type <code>JR1971_Output</code> that contains the following fields:</p><ul><li><code>nN2</code>: Number density of N₂ [1/m³].</li><li><code>nO2</code>: Number density of O₂ [1/m³].</li><li><code>nO</code>: Number density of O [1/m³].</li><li><code>nAr</code>: Number density of Ar [1/m³].</li><li><code>nHe</code>: Number density of He [1/m³].</li><li><code>nH</code>: Number density of H [1/m³].</li><li><code>rho</code>: Total density [kg/m³].</li><li><code>T_exo</code>: Exospheric temperature [K].</li><li><code>Tz</code>: Temperature at the selected altitude [K].</li></ul><pre><code class="language-julia-repl">julia&gt; jr1971(date_to_jd(2018, 6, 19, 18, 35, 0), deg2rad(-22), deg2rad(-45), 700e3, 79, 73.5, 1.34)
JR1971_Output{Float64}
  nN2: Float64 2.8434980991303828e7
  nO2: Float64 174222.87498004676
  nO: Float64 1.4139107014677634e11
  nAr: Float64 8.972570981074634
  nHe: Float64 8.773885389988534e11
  nH: Float64 5.702781005702269e10
  rho: Float64 9.684902904883958e-15
  T_exo: Float64 832.0244272210394
  Tz: Float64 832.0204436414625</code></pre><h2 id="Jacchia-Bowman-2008"><a class="docs-heading-anchor" href="#Jacchia-Bowman-2008">Jacchia-Bowman 2008</a><a id="Jacchia-Bowman-2008-1"></a><a class="docs-heading-anchor-permalink" href="#Jacchia-Bowman-2008" title="Permalink"></a></h2><p>This is an empirical thermospheric density model based on the Jacchia theory. It was published in:</p><blockquote><p><strong>Bowman, B. R., Tobiska, W. K., Marcos, F. A., Huang, C. Y., Lin, C. S., Burke, W. J (2008)</strong>. <em>A new empirical thermospheric density model JB2008 using new solar and geomagnetic indices.</em> <strong>In the proeceeding of the AIAA/AAS Astrodynamics Specialist Conference</strong>, Honolulu, Hawaii.</p></blockquote><p>For more information, visit <a href="http://sol.spacenvironment.net/jb2008">http://sol.spacenvironment.net/jb2008</a>.</p><p>In this toolbox, the model can be evaluated using the following functions:</p><pre><code class="language-julia">function jb2008(JD::Number, glat::Number, glon::Number, h::Number)
function jb2008(JD::Number, glat::Number, glon::Number, h::Number, F10::Number, F10ₐ::Number, S10::Number, S10ₐ::Number, M10::Number, M10ₐ::Number, Y10::Number, Y10ₐ::Number, DstΔTc::Number)</code></pre><p>in which:</p><ul><li><code>JD</code>: Julian day.</li><li><code>glat</code>: Geocentric latitude [rad].</li><li><code>glon</code>: Geocentric longitude [rad].</li><li><code>h</code>: Altitude [m].</li><li><code>F10</code>: 10.7-cm solar flux [10⁻²² W/(M² Hz)] (Tabular time 1 day earlier).</li><li><code>F10ₐ</code>: 10.7-cm averaged solar flux, 81-day centered on input time (Tabular         time 1 day earlier).</li><li><code>S10</code>: EUV index (26-34 nm) scaled to F10.7 (Tabular time 1 day earlier).</li><li><code>S10ₐ</code>: EUV 81-day averaged centered index (Tabular time 1 day earlier).</li><li><code>M10</code>: MG2 index scaled to F10.7 (Tabular time 2 days earlier).</li><li><code>M10ₐ</code>: MG2 81-day averaged centered index (Tabular time 2 days earlier).</li><li><code>Y10</code>: Solar X-ray &amp; Lya index scaled to F10.7 (Tabular time 5 days earlier).</li><li><code>Y10ₐ</code>: Solar X-ray &amp; Lya 81-day averaged centered index (Tabular time 5 days         earlier).</li><li><code>DstΔTc</code>: Temperature variation related to the Dst.</li></ul><p>If the parameters related with the space indices are not provided (first signature), then they will be automatically obtained. This, however, requires the initialization of the space indices (see [Space indices]).</p><p>These functions returns an object of type <code>JB2008_Output</code> that contains the following fields:</p><ul><li><code>nN2</code>: Number density of N₂ [1/m³].</li><li><code>nO2</code>: Number density of O₂ [1/m³].</li><li><code>nO</code>: Number density of O [1/m³].</li><li><code>nAr</code>: Number density of Ar [1/m³].</li><li><code>nHe</code>: Number density of He [1/m³].</li><li><code>nH</code>: Number density of H [1/m³].</li><li><code>rho</code>: Total density [kg/m³].</li><li><code>T_exo</code>: Exospheric temperature [K].</li><li><code>Tz</code>: Temperature at the selected altitude [K].</li></ul><pre><code class="language-julia-repl">julia&gt; jb2008(date_to_jd(2018, 6, 19, 18, 35, 0), deg2rad(-22), deg2rad(-45), 700e3, 79, 73.5, 55.1, 53.8, 78.9, 73.3, 80.2, 71.7, 50)
JB2008_Output{Float64}
  nN2: Float64 2.6541724729332495e7
  nO2: Float64 193981.21643718384
  nO: Float64 7.674571609797285e10
  nAr: Float64 13.375957587876071
  nHe: Float64 4.642052516165976e11
  nH: Float64 4.072455917445681e10
  rho: Float64 5.193318161219548e-15
  T_exo: Float64 819.7144509572893
  Tz: Float64 826.7686603272322</code></pre><h2 id="NRLMSISE-00"><a class="docs-heading-anchor" href="#NRLMSISE-00">NRLMSISE-00</a><a id="NRLMSISE-00-1"></a><a class="docs-heading-anchor-permalink" href="#NRLMSISE-00" title="Permalink"></a></h2><p>The NRLMSIS-00 empirical atmosphere model was developed by Mike Picone, Alan Hedin, and Doug Drob based on the MSISE90 model:</p><blockquote><p><strong>Picone, J. M., Hedin, A. E., Drob, D. P., Aikin, A. C (2002)</strong>. <em>NRLMSISE-00 empirical model of the atmosphere: Statistical comparisons and scientific issues</em>. <strong>Journal of Geophysical Research: Space Physics</strong>, Vol. 107 (A12), p. SIA 15-1 – SIA 15-16, DOI: 10.1029/2002JA009430.</p></blockquote><p>In this toolbox, the model can be evaluated using the following function:</p><pre><code class="language-julia">function nrlmsise00(JD::Number, alt::Number, g_lat::Number, g_long::Number [, f107A::Number, f107::Number, ap::Union{Number,AbstractVector}]; output_si::Bool = true, dversion::Bool = true)</code></pre><p>in which:</p><ul><li><code>JD</code>: Julian Day [UTC].</li><li><code>alt</code>: Altitude [m].</li><li><code>g_lat</code>: Geodetic latitude [rad].</li><li><code>g_long</code>: Geodetic longitude [rad].</li><li><code>f107A</code>: 81 day average of F10.7 flux (centered on day of year <code>doy</code>).</li><li><code>f107</code>: Daily F10.7 flux for previous day.</li><li><code>ap</code>: Magnetic index.</li></ul><p>If the keyword <code>output_si</code> is <code>true</code>, then the output will be in [m⁻³] for species number density and [kg/m⁻³] for the total density. Otherwise, the units will be [cm⁻³] and [g/cm⁻³], respectively.</p><p>The keyword <code>dversion</code> can be used to select which algorithm will be used to compute the model. If it is set to <code>true</code>, then it will call the <code>gtd7d</code> function that includes the anomalous oxygen in the total density. Otherwise, the function <code>gtd7</code> will be called and the anomalous oxygen will not be added in the total density.</p><p>The parameter <code>ap</code> can be a number or a vector. If it is a number, then it must be the daily magnetic index. If it is a vector, then it must contain 7 elements as follows:</p><table><tr><th style="text-align: right">Index</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: right">1</td><td style="text-align: left">Daily AP.</td></tr><tr><td style="text-align: right">2</td><td style="text-align: left">3 hour AP index for current time.</td></tr><tr><td style="text-align: right">3</td><td style="text-align: left">3 hour AP index for 3 hours before current time.</td></tr><tr><td style="text-align: right">4</td><td style="text-align: left">3 hour AP index for 6 hours before current time.</td></tr><tr><td style="text-align: right">5</td><td style="text-align: left">3 hour AP index for 9 hours before current time.</td></tr><tr><td style="text-align: right">6</td><td style="text-align: left">Average of eight 3 hour AP indices from 12 to 33 hours prior to current time.</td></tr><tr><td style="text-align: right">7</td><td style="text-align: left">Average of eight 3 hour AP indices from 36 to 57 hours prior to current time.</td></tr></table><p>If the parameters related with the space indices are not provided (<code>f107A</code>, <code>f107</code>, and <code>ap</code>), then they will be automatically obtained. This, however, requires the initialization of the space indices (see [Space indices]).</p><p>The function return an object of type <code>NRLMSISE00_Output</code> that contains the following fields:</p><ul><li><code>den_N</code>: Nitrogen number density [U].</li><li><code>den_N2</code>: N₂ number density [U].</li><li><code>den_O</code>: Oxygen number density [U].</li><li><code>den_aO</code>: Anomalous Oxygen number density [U].</li><li><code>den_O2</code>: O₂ number density [U].</li><li><code>den_H</code>: Hydrogen number density [U].</li><li><code>den_He</code>: Helium number density [U].</li><li><code>den_Ar</code>: Argon number density [U].</li><li><code>den_Total</code>: Total mass density [T/U] (this value has different meanings for routines <code>gtd7</code> and <code>gtd7d</code>).</li><li><code>T_exo</code>: Exospheric temperature [K].</li><li><code>T_alt</code>: Temperature at the selected altitude [K].</li><li><code>flags</code>: Flags used to compute NRLMSISE-00 model.</li></ul><p>Notice that:</p><ul><li>If <code>flags[:output_m_kg]</code> is <code>false</code>, then [U] is [cm⁻³] and [T] is [g/cm⁻³].</li><li>If <code>flags[:output_m_kg]</code> is <code>true</code>, then [U] is [m⁻³] and [T] is [kg/m⁻³].</li></ul><pre><code class="language-julia-repl">julia&gt; nrlmsise00(date_to_jd(2018, 6, 19, 18, 35, 0), 700e3, deg2rad(-22), deg2rad(-45), 73.5, 79, 5.13)
NRLMSISE00_Output{Float64}
  den_N: Float64 5.597834653523333e9
  den_N2: Float64 5.743312510585916e7
  den_O: Float64 1.2705655159941983e11
  den_aO: Float64 2.4185558056141124e9
  den_O2: Float64 340464.9752380828
  den_H: Float64 1.2667781795293002e11
  den_He: Float64 6.248499395447589e11
  den_Ar: Float64 23.18462060029951
  den_Total: Float64 7.930928885098513e-15
  T_exo: Float64 837.4122645268103
  T_alt: Float64 837.4119807046409
  flags: NRLMSISE00_Flags</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If the user wants more control over the NRLMSISE-00, they can use the low-level functions <code>gtd7</code> and <code>gtd7d</code>, which has the same functionality as available in the FORTRAN version of the model. See the documentation of the functions for more information.</p></div></div><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>[1] <strong>Vallado, D. A., McClain, W. D (2013).</strong> <em>Fundamentals of astrodynamics and applications</em>. Hawthorne, CA: Microcosm Press.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../">« Home</a><a class="docs-footer-nextpage" href="../geomagnetic_field_models/">Earth geomagnetic field models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 14 June 2021 20:16">Monday 14 June 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
